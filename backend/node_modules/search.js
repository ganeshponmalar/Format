import React, { useState } from 'react';

import axios from 'axios';

export default function Form() {

  const [orderNumber, setOrderNumber] = useState('');  //this checking orderNumber

  const [data, setData] = useState('');   //checking the response and  fetching formated JSON 

  const [loading, setLoading] = useState(false); //loading the state

  const [errorMessage, setErrorMessage] = useState(''); //checking the error message 

  

  const handleFetchData = async () => {

    setLoading(true);

    setData('');

    setErrorMessage('');

    try {

      const response = await axios.get(`http://localhost:5000/formats/${orderNumber}`);

      console.log(response)

      if (response.status === 200) {

        if (response.data) {

          setData(response.data);

        } else {

          setErrorMessage('Data not available in DataBase');

        }

      } else {

        setErrorMessage('An error occurred');

      }

    } catch (error) {

      console.log('Error', error);

      setErrorMessage('data not Found');

    } finally {

      setLoading(false);

    }
  };

  return (

    <div className='container'>

      <label className='label' htmlFor='orderNumber'>

        Order Number:

      </label>

      <textarea
      
        type='text'

        value={orderNumber}

        onChange={(e) => setOrderNumber(e.target.value)}

        placeholder='Enter order number'

        className='text-a'

      />

      <br />

      <button className='btn' onClick={handleFetchData}>

        Fetch Data
        
      </button>

      {loading && <p>Loading...</p>}

      {errorMessage && <p className='error-message'>{errorMessage}</p>}

      {data && (

        <div className='details'>

          {/* Separate div for displaying details */}

          <pre className='json-format'>{JSON.stringify(data, null, 2)}</pre>

        </div>

      )}

    </div>
  );
}
